# SQL
SELECT AH.A_ID,AH.USER_ID,AH.DATE,QH.Q_TITLE,AD.Q_NO,QD.Q_TEXT,CASE AD.ANSWER_RES_ID WHEN 0 THEN AD.ANSWER ELSE AD.ANSWER || '(' || AK.ANSWER_NAME || ')' END ANSWER
FROM T_ANSWER_HEAD AH
INNER JOIN (SELECT *,CASE ANSWER WHEN ~ '[0-9]+' THEN CAST(ANSWER as signed) ELSE 0 END ANSWER_RES_ID FROM T_ANSWER_DETAIL) AD 
	ON AH.A_ID =  AD.A_ID AND AD.DELETE_FLG = FALSE
INNER JOIN T_QUESTION_DETAIL QD ON QD.Q_ID =  AD.Q_ID AND QD.Q_NO = AD.Q_NO AND QD.DELETE_FLG = FALSE
INNER JOIN T_QUESTION_HEAD QH ON QD.Q_ID =  QH.Q_ID AND QH.DELETE_FLG = FALSE
INNER JOIN T_ANSWER_KIND AK ON AK.ANSWER_KIND_ID = QD.ANSWER_KIND_ID AND ((AK.ANSWER_KIND_NO = AD.ANSWER_RES_ID) OR AD.ANSWER_RES_ID = 0 ) AND AK.DELETE_FLG = FALSE
WHERE AH.DELETE_FLG = FALSE
ORDER BY AH.A_ID,AD.Q_NO;

SELECT AH.A_ID,AH.USER_ID,AH.DATE,QH.Q_TITLE,AD.Q_NO,QD.Q_TEXT,CASE AD.ANSWER_RES_ID WHEN 0 THEN AD.ANSWER ELSE AD.ANSWER || '(' || AK.ANSWER_NAME || ')' END ANSWER
FROM T_ANSWER_HEAD AH
INNER JOIN (SELECT *,CASE WHEN ANSWER REGEXP '^[0-9]+$' THEN CAST(ANSWER as signed) ELSE 0 END ANSWER_RES_ID FROM T_ANSWER_DETAIL) AD 
	ON AH.A_ID =  AD.A_ID AND AD.DELETE_FLG = FALSE
INNER JOIN T_QUESTION_DETAIL QD ON QD.Q_ID =  AD.Q_ID AND QD.Q_NO = AD.Q_NO AND QD.DELETE_FLG = FALSE
INNER JOIN T_QUESTION_HEAD QH ON QD.Q_ID =  QH.Q_ID AND QH.DELETE_FLG = FALSE
INNER JOIN T_ANSWER_KIND AK ON AK.ANSWER_KIND_ID = QD.ANSWER_KIND_ID AND ((AK.ANSWER_KIND_NO = AD.ANSWER_RES_ID) OR AD.ANSWER_RES_ID = 0 ) AND AK.DELETE_FLG = FALSE
WHERE AH.DELETE_FLG = FALSE
ORDER BY AH.A_ID,AD.Q_NO;

